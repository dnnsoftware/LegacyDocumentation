<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="1130" MadCap:lastWidth="1650">
    <head>
    </head>
    <body>
        <h1>Setting the DNN Data Source</h1>
        <p>How to set the DNN Data Source option on the Active Data Source field on the Reports module. The DNN Data Source retrieves data by executing a SQL query against the database configured for your DNN application. This makes it an easy way to quickly retrieve data about your site. For example, the following query retrieves a table of all the pages in your site:</p>
        <p>SELECT * FROM {oQ}Tabs
        </p>
        <p>Aside from the standard SQL syntax, this data source accepts two special 'tokens' which will be replaced when the query is run. The "{oQ}" token is replaced with the object qualifier you have configured for your database. The "{dO}" token is replaced with the database owner you have configured for your database. You can also use the longer "{objectQualifier}" and "{databaseOwner}" tokens if you wish. This allows your queries to be moved between database configurations without changing the query.</p>
        <p>Here's how to set the DNN Data Source:</p>
        <ol start="1">
            <li value="1">
                <MadCap:snippetText src="../../../../../../Resources/Snippets/Module Settings.flsnp" />
            </li>
            <li value="2">Select the <b>Report Settings </b>tab.  </li>
            <li value="3">Go to the <b>Data Source Settings</b> section. </li>
            <li value="4">In the <b>Title </b>text box, enter a title for the report.&#160; </li>
            <li value="5"><b>Optional. </b>In the <b>Description </b>text box, enter a description of the report.&#160; </li>
            <li value="6">At <b>Active Data Source</b>, select <b>DotNetNuke Data Source</b>.</li>
            <li value="7">Select one of the following options: <ul start="1"><li value="1">At <b>Upload SQL File</b>, select the&#160;file on your local machine and it will be uploaded and placed in the Query text box. NOTE: You must still click Update at the bottom of the page to save the query. </li><li value="2">In the <b>Query</b> text box, enter the <b>SQL Query</b> to execute on the database.</li></ul></li>
            <li value="8"><b>Optional. </b>Click the <u>Test Data Source</u> link to test your data source. <ul start="8"><li value="1"><b>Optional. </b>Click the <u>Hide Results</u> link to hide the test results.</li></ul></li>
            <li><b>Optional. </b>Click the <u>Show Xml Source</u> link&#160;view the Xml of your&#160;data source. <ul start="8"><li value="1"><b>Optional. </b>Click the <u>Hide Xml Source</u> link to hide the source.</li></ul></li>
            <li value="10">
                <MadCap:snippetText src="../../../../../../Resources/Snippets/Update.flsnp" />
            </li>
        </ol>
        <p class="tip">Tip: Both the Title and the Description are displayed on the module when <b>Show Info Pane</b> is checked. The title and description are exported with the report when Export Content is selected from the module actions menu.</p>
        <p><b>Parameters</b>: The DNN Data Source supports the four parameters&#160;listed in the&#160;"Parameterized Queries" tutorial. For example, to retrieve the record in the Users table corresponding to the current user, use the following query:</p>
        <p>SELECT * FROM {oQ}Users WHERE UserID =   @UserID</p>
        <p>
            <img src="../../../../Resources/Images/Modules/Report/Rep_Settings_DotNetNukeDataSource.PNG">
                <br />
                <br />
            </img>
            <br /><small>Setting the DNN Data Source</small>
        </p>
    </body>
</html>